
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A modular web crawling and data extraction pipeline.">
      
      
      
        <link rel="canonical" href="https://purvik-31.github.io/website-crawler/architecture/">
      
      
        <link rel="prev" href="../output-format/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Architecture - Website Ingestion Pipeline</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Website Ingestion Pipeline" class="md-header__button md-logo" aria-label="Website Ingestion Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Website Ingestion Pipeline
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Architecture
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/PURVIK-31/website-crawler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PURVIK-31/website-crawler
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Website Ingestion Pipeline" class="md-nav__button md-logo" aria-label="Website Ingestion Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Website Ingestion Pipeline
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PURVIK-31/website-crawler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PURVIK-31/website-crawler
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../output-format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Output Format
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pipeline-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Flow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Module Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Module Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Modules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extractors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extractors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Compose
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Volumes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Environment Variables
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pipeline-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Flow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Module Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Module Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Modules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extractors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extractors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Compose
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Volumes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Environment Variables
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">&para;</a></h1>
<p>This page describes the internal design of the pipeline, the role of each module, and the Docker deployment configuration.</p>
<hr />
<h2 id="pipeline-flow">Pipeline Flow<a class="headerlink" href="#pipeline-flow" title="Permanent link">&para;</a></h2>
<p>The crawl lifecycle follows a linear pipeline from URL discovery through data export.</p>
<pre class="mermaid"><code>flowchart TD
    Seed["Seed URL"] --&gt; Frontier["URL Frontier"]
    Frontier --&gt; RobotsCheck["Robots.txt Check"]
    RobotsCheck --&gt;|allowed| Fetcher["Page Fetcher"]
    RobotsCheck --&gt;|blocked| Skip["Skip URL"]
    Fetcher --&gt;|static| Parser["HTML Parser"]
    Fetcher --&gt;|"JS-heavy (fallback)"| Playwright["Playwright Renderer"]
    Playwright --&gt; Parser
    Parser --&gt; Extractors["Extractor Pipeline"]
    Extractors --&gt; TextExtractor["Text Extractor"]
    Extractors --&gt; ImageExtractor["Image Extractor"]
    Extractors --&gt; LinkExtractor["Link Extractor"]
    TextExtractor --&gt; Structurer["Data Structurer"]
    ImageExtractor --&gt; Structurer
    LinkExtractor --&gt;|internal| Frontier
    LinkExtractor --&gt;|external| Structurer
    Structurer --&gt; Export["Export"]
    Export --&gt; Parquet["Parquet / CSV / JSONL"]
    Export --&gt; Readable["Markdown"]
    Export --&gt; Report["Crawl Report"]
    Export --&gt; Manifest["Manifest"]</code></pre>
<ol>
<li>The <strong>seed URL</strong> is added to the frontier at depth 0.</li>
<li>The <strong>frontier</strong> manages the BFS queue, normalizes URLs, filters by domain, and prevents revisits.</li>
<li><strong>Robots.txt</strong> rules are checked per-domain (cached). Blocked URLs are skipped.</li>
<li>The <strong>fetcher</strong> makes an async HTTP request. If the response appears JavaScript-heavy (low text-to-HTML ratio), it falls back to Playwright/Chromium.</li>
<li>The <strong>parser</strong> strips scripts, styles, and non-content elements, then uses <code>readability-lxml</code> to extract the main content.</li>
<li>The <strong>extractor pipeline</strong> runs three extractors in sequence: text (title, headings, meta, body), images (download and deduplicate), and links (classify internal vs. external, filter noise).</li>
<li>Internal links are enqueued back into the frontier at <code>depth + 1</code>.</li>
<li>All extracted data accumulates in the <strong>structurer</strong>, which exports datasets at the end of the crawl.</li>
</ol>
<hr />
<h2 id="module-overview">Module Overview<a class="headerlink" href="#module-overview" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>main.py                         Entry point (CLI + API router)
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>app/
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├── api.py                      FastAPI REST interface
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>├── job_manager.py              Job orchestration and lifecycle
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>├── crawler.py                  BFS crawl loop
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>├── fetcher.py                  Async HTTP client + Playwright fallback
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>├── frontier.py                 URL queue, normalization, deduplication
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>├── robots.py                   Robots.txt fetching and rule checking
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>├── parser.py                   HTML parsing with readability-lxml
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>├── structurer.py               Data aggregation and dataset export
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>├── raw_storage.py              Gzip HTML archival with metadata
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>├── dataset_storage.py          Manifest creation and ZIP packaging
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>├── config.py                   Pydantic configuration models
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>├── logger.py                   Structured logging via structlog
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>└── extractors/
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    ├── __init__.py             Pipeline orchestrator
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    ├── text.py                 Title, headings, meta extraction
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    ├── link.py                 Link classification and filtering
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    └── image.py                Image download and deduplication
</code></pre></div>
<h3 id="core-modules">Core Modules<a class="headerlink" href="#core-modules" title="Permanent link">&para;</a></h3>
<p><strong><code>job_manager.py</code></strong> -- Validates inputs, builds a <code>CrawlConfig</code>, creates the output directory, launches the crawler, triggers export, and creates the manifest. This is the top-level orchestrator called by both the CLI and API.</p>
<p><strong><code>crawler.py</code></strong> -- Implements the BFS loop. Pops URLs from the frontier, checks robots.txt, fetches, parses, extracts, and enqueues discovered links. Tracks progress with a Rich progress bar.</p>
<p><strong><code>fetcher.py</code></strong> -- Async HTTP client using <code>aiohttp</code>. Supports user-agent rotation, rate limiting (enforced via semaphore and sleep), and retries with exponential backoff. Detects JavaScript-heavy pages by heuristic and falls back to Playwright/Chromium.</p>
<p><strong><code>frontier.py</code></strong> -- Priority queue (heapq) ordered by depth for BFS traversal. Normalizes URLs (lowercase host, strip fragments, remove tracking parameters like <code>utm_*</code>, <code>fbclid</code>, <code>gclid</code>). Maintains a visited set using SHA-256 hashes.</p>
<p><strong><code>parser.py</code></strong> -- Strips non-content tags (script, style, noscript, iframe, svg). Detects encoding with <code>chardet</code>. Uses <code>readability-lxml</code> for main content extraction, with a fallback to the full body if readability is too aggressive.</p>
<p><strong><code>structurer.py</code></strong> -- Accumulates page records, image metadata, external links, and errors during the crawl. At export time, builds Pandas DataFrames and writes to Parquet, CSV, or JSONL. Also generates the crawl report JSON and human-readable Markdown exports.</p>
<h3 id="extractors">Extractors<a class="headerlink" href="#extractors" title="Permanent link">&para;</a></h3>
<p><strong><code>text.py</code></strong> -- Extracts the page title (from <code>&lt;title&gt;</code> or first <code>&lt;h1&gt;</code>), all headings (h1--h6 with levels), and the meta description (from <code>&lt;meta name="description"&gt;</code> or <code>og:description</code>).</p>
<p><strong><code>link.py</code></strong> -- Resolves relative URLs, classifies links as internal or external based on domain, and filters noise (login pages, admin paths, social media, mailto/tel links, binary files).</p>
<p><strong><code>image.py</code></strong> -- Finds images via <code>&lt;img&gt;</code> tags (including <code>data-src</code> and <code>data-lazy-src</code> attributes). Downloads asynchronously, filters by minimum dimension, deduplicates using perceptual hashing (<code>imagehash</code>), and stores files named by SHA-256 content hash.</p>
<hr />
<h2 id="docker-configuration">Docker Configuration<a class="headerlink" href="#docker-configuration" title="Permanent link">&para;</a></h2>
<h3 id="container">Container<a class="headerlink" href="#container" title="Permanent link">&para;</a></h3>
<p>The Dockerfile uses a multi-stage build on <code>python:3.11-slim</code>:</p>
<ol>
<li><strong>Builder stage</strong> -- Installs build dependencies and compiles Python packages.</li>
<li><strong>Runtime stage</strong> -- Copies compiled packages, installs runtime system libraries (libxml2, libjpeg, libpng, Chromium dependencies, fonts), and installs the Playwright Chromium browser.</li>
</ol>
<p>The container exposes port <code>8000</code> and uses <code>/entrypoint.sh</code> as its entrypoint.</p>
<h3 id="docker-compose">Docker Compose<a class="headerlink" href="#docker-compose" title="Permanent link">&para;</a></h3>
<p>The <code>docker-compose.yml</code> defines a single service:</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Container name</td>
<td><code>web-crawler-api</code></td>
</tr>
<tr>
<td>Default command</td>
<td><code>serve</code></td>
</tr>
<tr>
<td>Port mapping</td>
<td><code>8000:8000</code></td>
</tr>
<tr>
<td>Memory limit</td>
<td>2 GB (512 MB reserved)</td>
</tr>
<tr>
<td>Restart policy</td>
<td><code>unless-stopped</code></td>
</tr>
<tr>
<td>Health check</td>
<td>HTTP request to <code>localhost:8000</code> every 30 seconds</td>
</tr>
</tbody>
</table>
<h3 id="volumes">Volumes<a class="headerlink" href="#volumes" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Mount</th>
<th>Container Path</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>crawler_data</code> (named volume)</td>
<td><code>/app/jobs</code></td>
<td>Persistent storage for API job data</td>
</tr>
<tr>
<td>Host Downloads folder</td>
<td><code>/app/downloads</code></td>
<td>Bind mount for CLI crawl output</td>
</tr>
</tbody>
</table>
<h3 id="environment-variables">Environment Variables<a class="headerlink" href="#environment-variables" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PIPELINE_DATA_DIR</code></td>
<td><code>/app/jobs</code></td>
<td>Base directory for API job storage</td>
</tr>
<tr>
<td><code>PORT</code></td>
<td><code>8000</code></td>
<td>API server port</td>
</tr>
<tr>
<td><code>WORKERS</code></td>
<td><code>1</code></td>
<td>Number of Uvicorn worker processes</td>
</tr>
<tr>
<td><code>PYTHONUNBUFFERED</code></td>
<td><code>1</code></td>
<td>Disable Python output buffering</td>
</tr>
<tr>
<td><code>PURUCRAWLER_DOWNLOADS</code></td>
<td><em>(user-specific)</em></td>
<td>Host path for the Downloads bind mount</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Package</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<td>aiohttp</td>
<td>Async HTTP client for page fetching</td>
</tr>
<tr>
<td>beautifulsoup4 + lxml</td>
<td>HTML parsing and DOM traversal</td>
</tr>
<tr>
<td>readability-lxml</td>
<td>Main content extraction from HTML</td>
</tr>
<tr>
<td>pandas + pyarrow</td>
<td>DataFrame operations and Parquet export</td>
</tr>
<tr>
<td>Pillow + imagehash</td>
<td>Image processing and perceptual deduplication</td>
</tr>
<tr>
<td>playwright</td>
<td>Headless Chromium for dynamic page rendering</td>
</tr>
<tr>
<td>fastapi + uvicorn</td>
<td>REST API server</td>
</tr>
<tr>
<td>typer + rich</td>
<td>CLI framework and terminal formatting</td>
</tr>
<tr>
<td>structlog</td>
<td>Structured, key-value logging</td>
</tr>
<tr>
<td>pydantic</td>
<td>Configuration validation and serialization</td>
</tr>
<tr>
<td>chardet</td>
<td>Character encoding detection</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "content.code.copy", "search.highlight", "search.suggest"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>